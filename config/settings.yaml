# Public configuration (safe to commit)
# Add crawler-specific config under `crawlers.<name>`.

http:
  user_agent: "OpenLibraryCrawler/0.1 (+https://github.com/<your-org>/<your-repo>)"
  timeout_seconds: 60
  max_retries: 3

crawlers:
  # HKSAR Government Press Releases daily listing crawler.
  # Iterates day-by-day for the last 2 years and extracts press release detail links
  # within div#contentBody.
  hksar_press_releases:
    base_url: "https://www.info.gov.hk"
    days_back: 730
    locales:
      - "en"
      - "tc"
    listing_path_template: "/gia/general/{yyyymm}/{dd}.htm"
    listing_path_template_tc: "/gia/general/{yyyymm}/{dd}c.htm"
    request_delay_seconds: 0.5
    request_jitter_seconds: 0.25
    per_day_limit: 200
    max_total_records: 50000
    backoff_base_seconds: 0.5
    backoff_jitter_seconds: 0.25

  # DevB Press Releases (English) index crawler.
  # Iterates year-by-year for the last N years, discovers page count via pagination,
  # and extracts (date, title, url) from table.articlelistpage.
  devb_press_releases:
    base_url: "https://www.devb.gov.hk"
    years_back: 10
    type: "all"
    request_delay_seconds: 0.5
    request_jitter_seconds: 0.25
    max_total_records: 50000
    backoff_base_seconds: 0.5
    backoff_jitter_seconds: 0.25

  # DevB Speeches and Presentations (English) index crawler.
  # Iterates year-by-year for the last N years, discovers page count via pagination
  # (or embedded hidden links), and extracts (date, title, url) from table.articlelistpage.
  devb_speeches_and_presentations:
    base_url: "https://www.devb.gov.hk"
    years_back: 10
    type: "all"
    request_delay_seconds: 0.5
    request_jitter_seconds: 0.25
    max_total_records: 50000
    backoff_base_seconds: 0.5
    backoff_jitter_seconds: 0.25

  # DevB General Circulars (English) crawler.
  # Currently extracts PDF links from a single listing page.
  devb_general_circulars:
    base_url: "https://www.devb.gov.hk"
    page_url: "https://www.devb.gov.hk/en/publications_and_press_releases/general_circulars/index.html"
    max_total_records: 50000
    backoff_base_seconds: 0.5
    backoff_jitter_seconds: 0.25

  # DevB Planning and Lands Technical Circulars (English) crawler.
  # Extracts PDF links from a single page containing multiple tables.
  devb_planning_and_lands_technical_circulars:
    base_url: "https://www.devb.gov.hk"
    page_url: "https://www.devb.gov.hk/en/publications_and_press_releases/technical_circulars/planning_and_lands_technical_circular/index.html"
    max_total_records: 50000
    backoff_base_seconds: 0.5
    backoff_jitter_seconds: 0.25

  # DevB Works Technical Circulars (in force) via JS dataset.
  # The page renders results client-side; we parse the backing dataset and
  # emulate the Issue Year search for the last N years.
  devb_works_technical_circulars_um:
    base_url: "https://www.devb.gov.hk"
    data_js_url: "https://www.devb.gov.hk/filemanager/technicalcirculars/list_technicalcirculars_53.js"
    years_back: 10
    include_revision_year_matches: true
    request_delay_seconds: 0.0
    request_jitter_seconds: 0.0
    max_total_records: 50000
    backoff_base_seconds: 0.5
    backoff_jitter_seconds: 0.25

  # DevB Publications (English) recursive document crawler.
  # Crawls only within the Publications section and emits only PDF/DOC/DOCX links.
  devb_publications:
    base_url: "https://www.devb.gov.hk"
    seed_url: "https://www.devb.gov.hk/en/publications_and_press_releases/publications/index.html"
    scope_prefix: "/en/publications_and_press_releases/publications/"
    content_element_id: "content"
    exclude_path_prefixes:
      - "/en/publications_and_press_releases/publications/glossary_of_terms"
      - "/en/publications_and_press_releases/publications/standardised_components_and_practices"
    max_depth: 6
    max_pages: 2000
    max_out_links_per_page: 500
    request_delay_seconds: 0.5
    request_jitter_seconds: 0.25
    max_total_records: 50000
    backoff_base_seconds: 0.5
    backoff_jitter_seconds: 0.25

  # Building Department codes, design manuals, and guidelines crawler.
  # Extracts PDF links from the single index page.
  codes_design_manuals_and_guidelines:
    base_url: "https://www.bd.gov.hk"
    page_url: "https://www.bd.gov.hk/en/resources/codes-and-references/codes-and-design-manuals/index.html"
    content_element_id: "content"
    request_delay_seconds: 0.25
    request_jitter_seconds: 0.10
    max_total_records: 50000
    backoff_base_seconds: 0.5
    backoff_jitter_seconds: 0.25

  # BD Practice Notes and Circular Letters.
  # Crawls 5 specific sub-pages (PNAP, PNRC, JPN, PNBI, Circular Letters).
  # Circular Letters includes a 10-year lookback via filtering.
  practice_notes_and_circular_letters:
    url_pnap: "https://www.bd.gov.hk/en/resources/codes-and-references/practice-notes-and-circular-letters/index_pnap.html"
    url_pnrc: "https://www.bd.gov.hk/en/resources/codes-and-references/practice-notes-and-circular-letters/index_pnrc.html"
    url_joint: "https://www.bd.gov.hk/en/resources/codes-and-references/practice-notes-and-circular-letters/index_joint.html"
    url_pnbi: "https://www.bd.gov.hk/en/resources/codes-and-references/practice-notes-and-circular-letters/index_pnbi.html"
    url_circulars: "https://www.bd.gov.hk/en/resources/codes-and-references/practice-notes-and-circular-letters/index_circulars.html"
    years_back: 10
    request_delay_seconds: 0.25
    request_jitter_seconds: 0.10
    backoff_base_seconds: 0.5
    backoff_jitter_seconds: 0.25

  # BD Central Data Bank crawler.
  # Crawls the CDB main page + 4 sub-pages and emits PDF links.
  # On the main page, only ADM-20 is emitted.
  central_data_bank:
    main_page_url: "https://www.bd.gov.hk/en/resources/codes-and-references/central-data-bank/CDB.html"
    subpage_urls:
      - "https://www.bd.gov.hk/en/resources/codes-and-references/central-data-bank/CDBBuildMaterial.html"
      - "https://www.bd.gov.hk/en/resources/codes-and-references/central-data-bank/CDBBuildComp.html"
      - "https://www.bd.gov.hk/en/resources/codes-and-references/central-data-bank/CDBConstructSys.html"
      - "https://www.bd.gov.hk/en/resources/codes-and-references/central-data-bank/CDBFSImprovementWorks.html"
    content_element_id: "content"
    request_delay_seconds: 0.25
    request_jitter_seconds: 0.10
    max_total_records: 50000
    backoff_base_seconds: 0.5
    backoff_jitter_seconds: 0.25

  # BD Modular Integrated Construction (MiC) crawler.
  # Emits the index page (HTML) + all PDF links found on it.
  # (Moved to bd_basic_pages)

  # BD Basic Pages crawler.
  # Handles miscellaneous single pages where we want to emit the page itself (HTML)
  # and all PDF links found on the page.
  bd_basic_pages:
    targets:
      - name: "modular_integrated_construction"
        title: "Modular Integrated Construction (MiC) Index"
        url: "https://www.bd.gov.hk/en/resources/codes-and-references/modular-integrated-construction/index.html"
        content_element_id: "content"
      - name: "pre_accepted_computer_programs"
        title: "Pre-accepted Computer Programs Index"
        url: "https://www.bd.gov.hk/en/resources/codes-and-references/pre-accepted-computer-programs/index.html"
        content_element_id: "content"
      - name: "precautionary_measures_typhoon_season"
        title: "Precautionary Measures for Typhoon Season Index"
        url: "https://www.bd.gov.hk/en/resources/codes-and-references/precautionary-measures-typhoon-season/index.html"
        content_element_id: "content"
      - name: "pv_panel"
        title: "Correct Installation of Photovoltaic (PV) System"
        url: "https://www.bd.gov.hk/en/resources/codes-and-references/pv-panel/index.html"
        content_element_id: "content"
      - name: "ibmt_pre_acceptance_mechanism"
        title: "Pre-acceptance Mechanism for Innovative Building Materials and Technologies"
        url: "https://www.bd.gov.hk/en/resources/codes-and-references/innovative-building-materials-and-technologies/index-pre-acceptance-mechanism.html"
        content_element_id: "content"
      - name: "ibmt_accepted_list"
        title: "Pre-accepted Innovative Building Materials and Technologies"
        url: "https://www.bd.gov.hk/en/resources/codes-and-references/innovative-building-materials-and-technologies/ibmt_acceptedList.html"
        content_element_id: "content"
    request_delay_seconds: 0.25
    request_jitter_seconds: 0.10
    max_total_records: 50000
    backoff_base_seconds: 0.5
    backoff_jitter_seconds: 0.25

  # BD Scheduled Areas crawler.
  # Emits all PDF links found on the page.
  scheduled_areas:
    page_url: "https://www.bd.gov.hk/en/resources/codes-and-references/scheduled-areas/index.html"
    content_element_id: "content"
    request_delay_seconds: 0.25
    request_jitter_seconds: 0.10
    max_total_records: 50000
    backoff_base_seconds: 0.5
    backoff_jitter_seconds: 0.25

  # BD Notices and Reports crawler.
  # Crawls Notices, Investigation Reports, and CEPAS subpages for PDF links.
  notices_and_reports:
    page_urls:
      - "https://www.bd.gov.hk/en/resources/codes-and-references/notices-and-reports/index_notice.html"
      - "https://www.bd.gov.hk/en/resources/codes-and-references/notices-and-reports/index_reports.html"
      - "https://www.bd.gov.hk/en/resources/codes-and-references/notices-and-reports/index_CEPAS.html"
    content_element_id: "content"
    request_delay_seconds: 0.25
    request_jitter_seconds: 0.10
    max_total_records: 50000
    backoff_base_seconds: 0.5
    backoff_jitter_seconds: 0.25

  # HKSAR Government Telephone Directory (English) people crawler.
  # Traverses department/subdepartment pages under tel.directory.gov.hk and emits
  # one record per person, deduplicated by office telephone number.
  tel_directory:
    index_url: "https://tel.directory.gov.hk/index_ENG.html"
    request_delay_seconds: 0.25
    request_jitter_seconds: 0.10
    max_pages: 2000
    max_total_records: 50000
    backoff_base_seconds: 0.5
    backoff_jitter_seconds: 0.25

  # ARCHSD Technical Documents crawler.
  # Starts from the Technical Documents hub page, discovers the 6 sections,
  # and recursively follows subsection pages to emit PDF links.
  #
  # Year filtering policy:
  # - If a page exposes a year selector that includes 2022, it only follows 2022+ year pages.
  # - If a year selector exists but 2022 is missing, it filters PDFs by best-effort year
  #   extraction from link text/URL.
  # - If there is no year selector, it keeps all PDFs on that page.
  archsd_technical_documents:
    base_url: "https://www.archsd.gov.hk"
    start_url: "https://www.archsd.gov.hk/en/reports/techinical-documents.html"
    min_year: 2022

    # Best-effort: if empty/unhelpful, it falls back to full-page link extraction.
    content_element_id: "content"

    allowed_page_path_prefixes:
      - "/en/publications-publicity/"
      - "/publications-publicity/"

    # Restrict emitted PDFs to relevant site paths (avoids unrelated banner PDFs).
    allowed_pdf_path_prefixes:
      - "/media/publications-publicity/"

    max_depth: 6
    max_pages: 2000
    max_out_links_per_page: 800
    request_delay_seconds: 0.25
    request_jitter_seconds: 0.10
    max_total_records: 50000
    backoff_base_seconds: 0.5
    backoff_jitter_seconds: 0.25

  # ARCHSD Practices and Guidelines crawler.
  # Crawls the Practices and Guidelines page and emits all PDF links it finds.
  # No year filtering.
  archsd_practices_and_guidelines:
    base_url: "https://www.archsd.gov.hk"
    start_url: "https://www.archsd.gov.hk/en/reports/practices-and-guidelines.html"

    # Best-effort: if empty/unhelpful, it falls back to full-page link extraction.
    content_element_id: "content"

    # Keep HTML traversal tight so we don't drift into other /en/reports pages via nav.
    explicit_allowed_page_paths:
      - "/en/reports/practices-and-guidelines.html"
      - "/en/reports/disclaimer-for-BIM-guides.html"
      - "/en/BIM-guides/index.html"
      - "/en/consultants-contractors/product-conformity-certification-schemes.html"

    allowed_page_path_prefixes:
      - "/en/ua/"
      - "/en/ua2/"
      - "/en/thepossiblepackage/"
      - "/en/BIM-guides/"

    # PDFs on this page commonly live under /media/reports/practices-and-guidelines/.
    allowed_pdf_path_prefixes:
      - "/media/reports/"
      - "/archsd/html/ua/"
      - "/archsd/html/ua2/"
      - "/media/consultants-contractors/"

    max_depth: 4
    max_pages: 500
    max_out_links_per_page: 800
    request_delay_seconds: 0.25
    request_jitter_seconds: 0.10
    max_total_records: 50000
    backoff_base_seconds: 0.5
    backoff_jitter_seconds: 0.25

  # Hong Kong Herbarium Plant Database crawler.
  # Calls the public JSON endpoint and emits one record per species_id.
  herbarium:
    api_url: "https://www.herbarium.gov.hk/plantdb/GetSpeciesList.php"

    # Mirrors the website's query options (cache-buster param intentionally omitted).
    plant_type:
      - "Angiosperms (dicotyledons)"
      - "Angiosperms (monocotyledons)"
      - "Gymnosperms"
      - "Pteridophytes"

    taxon_rank:
      - "family"
      - "genus"
      - "species"

    order_by: "family"
    page_size: 4000

    request_delay_seconds: 0.25
    request_jitter_seconds: 0.10
    max_total_records: 200000
    backoff_base_seconds: 0.5
    backoff_jitter_seconds: 0.25
